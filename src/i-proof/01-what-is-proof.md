# 証明とは何か？

## 1.1 命題

**定義.** 命題とは真または偽である文である．

以下の2つの文は命題である．前者は真で，後者は偽である．

**命題 1.1.1.**     \\( 2 + 3 = 5 \\)

**命題 1.1.2.**     \\( 1 + 1 = 3 \\)

命題の定義は当たり前のことを言っているように思えるかもしれないが，真偽のはっきりしない文を排除することができるので有用である．「おおロミオ，あなたはどうしてロミオなのか（疑問文）」や「Aをください！（命令文）」という文は命題ではない．また時と場合によって真偽が異なる命題，「今は5時だ」や「株価は明日上がるだろう」もここでは排除される．

残念ながら，命題であっても真偽を判断することは難しいことがある．

**主張 1.1.3** すべての非負整数 \\(n\\) について\\(n^2 + n + 41\\)は素数である．

これを検証してみる．この式を

\\[
p(n) ::= n^2 + n + 41.
\\]

という関数にすると，\\(p(0) = 41\\)から始めて，これは素数である，さらに続けて

\\[
p(1) = 43, p(2) = 47, p(3) = 53, \cdots, p(20) = 461.
\\]

で\\(p(0)\\)から\\(p(20)\\)までは全て素数である．非常にもっともらしい主張なので，\\(n\\)を大きくして\\(n=39\\)まで検証すると\\(p(39) = 1601\\)でここまで全て素数であることがわかる．

しかし\\(p(40) = 40^2 + 40 + 41 = 41 \cdot 41\\)でこれは素数ではない．なので主張 1.1.3 は偽であることがわかった．

実際には，定数でもない限り，整数係数を持つ多項式がすべての非負整数を素数に写すことができないことを示すのは難しいことではない（問題1.25を参照）．しかし上の例は，一般に無限の集合から有限のサンプルを取ることにより，主張の正当性を検証することはできないという点を強調している．

ところで，**すべての**非負整数という言い方をするための，特別な数学的記法がある．その記法を使うと主張1.1.3は以下のように書き換えられる（\\(p(n)\\)はすでに定義されているとする）．

\\[
\forall n \in \mathbb{N}. p(n)\ is\ prime.
\\]


\\(\forall\\)は"すべての(forall)"と読む．\\(\mathbb{N}\\)は非負整数全体の集合を表す．\\(\in\\)は"（左側）は（右側）の要素である(is a member of)"と読む．\\(\mathbb{N}\\)の後のピリオドは，単にフレーズを分けるための記号である．

極端な例を見てみる．

**予想．** [Eulerによる]方程式

\\[
a^4 + b^4 + c^4 = d^4
\\]

は\\(a, b, c, d\\)が非負整数の場合に解を持たない．これはEulerによって1769年に提出された予想だが，218年後にNoam Elkiesによって偽であることが証明された．具体的な解として，

\\[a = 95800, b = 217519, c = 414560, d = 422481\\]

が存在する．

論理記号を用いると，Eulerの予想は次のように書ける：

\\[
\forall a \in \mathbb{Z^{+}}\ \forall b \in \mathbb{Z^{+}}\ \forall c \in \mathbb{Z^{+}}\ \forall d \in \mathbb{Z^{+}}. a^4 + b^4 + c^4 \neq d^4.
\\]

ここで\\(\mathbb{Z^{+}}\\)は非負整数である．一連の\\(\forall\\)を書くのは煩雑なので次のように略記法が使える．

\\[
\forall a, b, c, d \in \mathbb{Z^{+}}. a^4 + b^4 + c^4 \neq d^4
\\]

次の例は有限からのサンプリングでは反証するのが難しい例を挙げる．以下の式を満たす最小の\\(x, y, z\\)は1000桁以上（！）になることが知られている．

**偽の主張．**\\(313(x^3 + y^3) = z^3\\)は\\(x, y, z \in \mathbb{Z^{+}.}\\)のとき解を持たない．

次に，肯定的に証明された予想の中で有名なものを示す．

**命題 1.1.4 (四色定理）** 地図は4色あればどの隣接する国とも塗り分けることができる．

四色定理は数々の間違った証明が発表されてきた．19世紀には間違いと分かるまで10年間支持されていた証明もあった．1976年にAppelとHakenという数学者によって煩雑な証明が発見された．この証明には4-彩色可能な地図を分類するためにコンピュータープログラムが用いられた．プログラムによっても分類できない地図が数千あったので，それはHakenとその助手（その中には15歳の娘がいた）によって手作業で検証された．

**命題 1.1.5** （Fermatの最終定理）． 整数\\(n > 2\\)において

\\[
x^n + y^n = z^n
\\]

を満たす整数\\(x, y, z\\)は存在しない．

この定理はかねてより4,000,000以下のnでは正しいことが知られていた．しかしこれまで見てきたように，それだけでは全てのnについて正しいと言うには足りない．先に見たEulerの（偽だった）予想と，この定理の間には明らかな相似が見られる．

次に真偽が不明な命題を見てみる．

**命題 1.1.6** （ゴールドバッハ予想） 2より大きい偶数は2つの素数の和で表される．

この予想は\\(10^{18}\\)まで正しいことが知られている．しかしながら全ての偶数について正しいかは誰も知らない．

さて，計算機科学者にとって証明すべき重要な事柄は，プログラムやシステムの正しさであり，それらが想定された動作を正しく行うどうかということである．プログラムというのは非常にバグりやすいものであり，多数の研究者や実務家がプログラムの正しさを証明する方法を模索している．CPUチップの世界ではこれらの努力は十分に成功していて，チップの動作が正しいことを証明する手法は，悪名高い過去の過ちを避けるために大手半導体メーカーによって日常的に利用されている．

プログラムとシステムを検証するための数学的手法の開発は，現在活発な研究領域である．我々は5章でそれらの手法を概観する．

## 1.2 述語

述語は，真偽が1つ以上の変数に依存している命題である．"nは完全平方である"この文は述語である．なぜかというと，この命題の真偽は変数nが与えられるまで分からないからである．例としてnが4として与えられたとすると，この述語は正しい命題"4は完全平方である"になる．注意すべきは，この述語を無理やり正しい命題にしようとする必要はないということだ．nを5とするとこの述語は偽の命題"5は完全平方である"になる．

関数風の記法が特定の変数値を取る述語を意味するものとして使われることがある．例えばPというアルファベットを使って

\\[
P(n) ::= "nは完全平方である"
\\]

として上の具体例をもう一度当てはめると，\\(P(4)\\)は真で\\(P(5)\\)は偽となる．

この述語の記法はあくまで関数風であり，普通の関数と混同してはいけない．述語\\(P\\)に\\(n\\)を与えると，結果は必ず**真か偽**になる．例として普通の関数\\(p(n) = n^2 + 1\\)に数を与えると，結果は**数量**になる．

## 1.3 公理的手法

今日の数学では公理から証明を積み上げていくという方法が取られていること，定理と補題と系(corollary)の説明．ZFCは8章で触れる．

## 1.4 我々の公理

ZFCは数学の基礎付けを行う上で重要だが，実用上はあまりに素朴すぎる．ZFCで定理の証明を行うことは，高級言語ではなくバイトコードでプログラムを書くことに等しい．ある見積もりによると，ZFCによる\\(2 + 2 = 4\\)の証明は20,000ステップにも及ぶ．なので本書ではZFCから始めずに，多数の公理を導入することにする．ここでは高校数学で習った有名な事実は軒並み採用する．

公理をたくさん採用すれば楽に数学を始められるのはいいとして，読者は公理の不正確な仕様が問題を起こすことを発見するかもしれない．あなたは証明の半ばでこう思うかもしれない「この些細な事実[と思われるもの]は証明すべきなのか，公理として扱うべきなのか？」．この問いに対する絶対的な答えはない．何を証明すべきで，何を仮定とすべきかは状況や伝えたい相手によって異なる．

### 1.4.1 論理的演繹

論理的演繹，または**推論規則**は，それまでに証明された命題から新しい命題を証明するために使われる．

基本的な推論規則の1つはモーダスポネンス（modus ponens）である．この規則は，\\(P\\)の証明に\\(PならばQ\\)の証明が伴うなら，それは\\(Q\\)の証明である，と言っている．

推論規則は時おり，以下のような面白い記法で書かれる．例としてモーダスポネンスは，

**規則．**

\\[
\frac{P, P\ ならば\ Q}{Q}
\\]

と記述される．

横線の上に書かれた文は前件（antecedent）という．対して横線の下に書かれた文は帰結（conclusion）または後件（consequent）という．

推論規則が満たすべき必須の条件は，**健全**であることである．\\(P, Q, \cdots\\)などの文字への真理値の割り当てにおいて，すべての前件は真である必要があり，また後件も真となる必要がある．真である公理から出発して，健全な推論規則を適用したならば，そこから証明される事柄はすべて真である．

モーダスポネンスの他にも多くの健全で自然な推論規則が存在する．以下に例を示す．

**規則．**

\\[
\frac{P\ ならば\ Q, Q\ ならば\ R}{P\ ならば\ R}
\\]

**規則．**

\\[
\frac{NOT(P)\ ならば\ NOT(Q)}{Q\ ならば\ P}
\\]

**以下は規則ではない．**

\\[
\frac{NOT(P)\ ならば\ NOT(Q)}{P\ ならば\ Q}
\\]

\\(P\\)が真で\\(Q\\)が偽のとき，前件は真となるが，後件は偽となる．これは健全ではない．

ただし，合法な推論規則について形式化を追究しすぎるのはよくない．証明は各ステップが明確で"論理的"であるべきだ．特に新しい事実を導き出す際に，それまでに証明された事実がどのように使われているかに気を払うこと．

### 1.4.2 証明のパターン

原則として，証明は，公理と以前に証明された命題から構成される，**任意の**論理的演繹の系列であることができる．はじめのうちは，この証明を構成する自由に圧倒されてしまうかもしれない．

ここで朗報がある．多くの証明は，ほんの一握りのテンプレートに従って行われているということである．当然それぞれの証明にはそれぞれのディテールがあるので考える必要はあるが，テンプレートがあれば証明を書き始める手がかりが掴めるようになる．以下の節（1.5〜1.8）では標準的なパターンを提示する．そこで基本的な考え方とありがちな落とし穴も示す．

## 1.5 含意による証明

**含意**とは，"もし\\(P\\)なら，\\(Q\\)である"という形式の命題である．"\\(P\\)ならば\\(Q\\)"であるともいう．

以下にいくつかの例を示す．

* （二次方程式）\\(ax^2 + bx + c = 0\\)かつ\\(a \neq 0\\)ならば，

\\[
x = \frac{(-b \pm \sqrt{b^2 - 4ac})}{2a}.
\\]

* （ゴールドバッハ予想 1.1.6の言い換え）\\(n\\)が2より大きい正の偶数ならば，\\(n\\)は2素数の和になる．

* もし\\(0 \leq x \leq 2\\)ならば，\\(-x^3 + 4x + 1 > 0\\)．

### 1.5.1 方法 1

"\\(P\\)ならば\\(Q\\)"を証明するためには，

1. "\\(P\\)と仮定する"と書く．
2. \\(Q\\)が論理的に従うことを示す

**例**

**定理 1.5.1** もし\\(0 \leq x \leq 2\\)ならば，\\(-x^3 + 4x + 1 > 0\\)．

この証明を書く前に，これがなぜ真と言えるのかを理解するための下ごしらえをする．

この不等号は\\(x=0\\)で確かに成立することがわかる（\\(1 > 0\\)）．\\(x\\)が増加すると，\\(4x\\)の（正の）項は初めのうちは\\(-x^3\\)の（負の）項より大きな度合いで増加する**ように思える**．具体的な数値で比べてみると，\\(x=1\\)で\\(4x = 4\\)だが，\\(-x^3 = -1\\)しかないことが分かる．\\(x^3\\)の項が支配的になるのは\\(x > 2\\)の場合である**ように思える**．\\(-x^3 + 4x\\)は\\(0 \leq x \leq 2\\)の間で負にならない**ように思える**．よって式全体は正の数になると考えることができる．

ここまでは順調である．ここから証明を書くには，上の**ように思える**という部分を，確かな論理的主張に置き換えていく必要がある．

ここでは\\(x^3 + 4x\\)の部分を因数分解することにより，より適切に主張を表現できるようになる．この式の因数分解は難しくない．

\\[
-x^3 + 4x = x(2 - x)(2 + x)
\\]

右辺を見てみよう．因数分解されたそれぞれの項を見ると，0から2の間では非負であることが分かる！そして非負の数の積は非負である．以上の考察を簡潔な証明に落とし込もう．

証明．\\(0 \leq x \leq 2\\)と仮定する．すると\\(x, 2-x, 2+x\\)は非負である．ゆえにこれらの項の積は非負である．よって，この積に1を加えた数は正数になる：

\\[
x(2-x)(x+2) + 1 > 0
\\]

左辺を展開すると

\\[
-x^3 + 4x + 1 > 0
\\]

これが証明すべき事柄であった．■

以上の証明方法を適用するには，以下の点に留意するべきである．

* 証明の論理的道筋を思い描くまでに，しばしば下ごしらえが必要になる．この下ごしらえはあなた次第でどんな無秩序にもなりうる．完全な行き止まりに陥ったり，ヘンテコな図式を描き散らかしたり，あられもない言葉を綴ったりすることがあるかもしれない．しかし最終的な証明はこの下ごしらえとは分離し，簡潔かつ明快にすべきである．
* 証明は"証明"という言葉とともに始まり，"■"または"QED"という区切りによって終結する．

### 1.5.2 方法2 対偶論法

\\(P ならば Q\\)は，その対偶と論理的に同じである．

\\[
NOT(Q) ならば NOT(P)．
\\]

対偶を証明することは，オリジナルの文を直接証明するより簡単な場合がある．対偶論法は以下のように進行する：

1. "対偶による証明を示す："と書き，元の文の対偶である命題を述べる．
2. 方法1と同様に進行する．

**例**

**定理 1.5.2．** もし\\(r\\)が無理数ならば，\\(\sqrt{r}\\)も無理数である．

ある数が整数の商と等しいとき，有理数であるという．つまりある数が\\(m/n\\)と等しい（\\(m, n\\)は整数）であるということである．有理数でない数を無理数という．よって，\\(r\\)が整数の比でないとき，\\(\sqrt{r}\\)も整数の比でないことを示す必要がある．これは実際複雑な文なので，"でない"を除去した対偶による証明を試みる：

証明． 対偶による証明を示す：もし\\(\sqrt{r}\\)が有理数ならば，\\(r\\)は有理数である．

\\(\sqrt{r}\\)が有理数であると仮定する．すると以下を満たす整数\\(m, n\\)が存在し，

\\[
\sqrt{r} = \frac{m}{n}
\\]

両辺を自乗すると，

\\[
r = \frac{m^2}{n^2}
\\]

\\(m^2, n^2\\)は整数であるため，\\(r\\)は有理数である．■

